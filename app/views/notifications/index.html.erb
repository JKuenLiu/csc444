<div class="container-fluid mt-3">
    <h1>Notifications</h1>
    <h2>Overdue</h2>
    <table>
        <% if @items_overdue %>
            <% @items_overdue.each do |interaction| %>
                <tr>
                    <td>
                        <%= "#{Item.find_by_id(interaction.item_id).name}" %> was due on
                        <%= "#{interaction.end_date}" %>
                    </td>
                </tr>
            <% end %>
        <% end %>
    </table>
    <h2>Reminders</h2>
    <table>
        <% if @items_approaching_due_date %>
            <% @items_approaching_due_date.each do |interaction| %>
                <tr>
                    <td>
                        <%= "#{Item.find_by_id(interaction.item_id).name}" %> you borrowed is due
                        <% if (Date.today - interaction.end_date).to_i == 0 %>
                            today
                        <% elsif (Date.today - interaction.end_date).to_i == 1 %>
                            tomorrow
                        <% else %>
                            in <%= "#{(Date.today - interaction.end_date).to_i}" %> days
                        <% end %>
                    </td>
                </tr>
            <% end %>
        <% end %>
    </table>
    <h2>Requests</h2>
    <table>
        <% if @pending_requests %>
            <% @pending_requests.each do |interactions| %>
                <% interactions.each do |interaction| %>
                	<% interaction_person = Person.find(interaction.person_id) %>
                	<% interaction_item   = Item.find(interaction.item_id) %>
                    <tr>
                		<td>
                            <%= link_to "#{interaction_person.fname + " " + interaction_person.lname}",
                                person_path(interaction_person) %>
                            has requested to borrow your item <%= interaction_item.name %>
                        </td>
                		<td>
                            <%= link_to 'Approve',
                                {controller: :interactions,
                                 action: :create,
                                 item_id: interaction.item_id,
                                 interaction: {
                                     request_type: 1,
                                     start_date: interaction.start_date,
                                     end_date: interaction.end_date,
                                     person_id: interaction.person_id}}, method: :post %>
                        </td>
                    </tr>
                <% end %>
            <% end %>
        <% end %>
    </table>
</div>
